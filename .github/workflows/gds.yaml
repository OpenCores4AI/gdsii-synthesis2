name: Generate GDSII

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  gds:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Build GDS with TinyTapeout
        uses: TinyTapeout/tt-gds-action@tt10
        with:
          # Para VHDL, a veces es necesario forzar la variable de entorno
          # que habilita el plugin GHDL en Yosys dentro del contenedor.
          yosys_env: "GHDL_PLUGIN=1"

      - name: Upload GDSII Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: gds_files
          path: runs/wokwi/results/final/gds/*
